indicators:
  - key: "cbhs-1a-jumla-me"
    grouping: "CBHS"
    description: "Number of Male clients enrolled to HIV services until last month"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                         fm.gender = 'Male'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 9, 2)) <
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-1a-jumla-ke"
    grouping: "CBHS"
    description: "Number of Female clients enrolled to HIV services until last month"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                         fm.gender = 'Female'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 9, 2)) <
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-1b-jumla-me"
    grouping: "CBHS"
    description: "Total Male continuing with care this month"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.registration_or_followup_status = 'continuing_with_services'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-1b-jumla-ke"
    grouping: "CBHS"
    description: "Total Female continuing with care this month"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.registration_or_followup_status = 'continuing_with_services'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-jumla-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-jumla-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-1-me"
    grouping: "CBHS"
    description: "Total new male clients less than one year old registered this month"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+1 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-1-ke"
    grouping: "CBHS"
    description: "Total new female clients less than one year old registered this month"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+1 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-1-5-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 1-5 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+1 years') <= date('now'))
                      AND (date(fm.dob, '+6 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-1-5-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 1-5 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+1 years') <= date('now'))
                      AND (date(fm.dob, '+6 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-6-9-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 6-9 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+6 years') <= date('now'))
                      AND (date(fm.dob, '+10 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-6-9-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 6-9 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+6 years') <= date('now'))
                      AND (date(fm.dob, '+10 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-10-14-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 10-14 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+10 years') <= date('now'))
                      AND (date(fm.dob, '+15 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-10-14-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 10-14 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+10 years') <= date('now'))
                      AND (date(fm.dob, '+15 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-15-19-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 15-19 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+15 years') <= date('now'))
                      AND (date(fm.dob, '+20 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-15-19-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 15-19 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+15 years') <= date('now'))
                      AND (date(fm.dob, '+20 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-20-24-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 20-24 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+20 years') <= date('now'))
                      AND (date(fm.dob, '+25 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-20-24-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 20-24 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+20 years') <= date('now'))
                      AND (date(fm.dob, '+25 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-25-49-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 25-49 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+25 years') <= date('now'))
                      AND (date(fm.dob, '+50 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-25-49-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 25-49 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+25 years') <= date('now'))
                      AND (date(fm.dob, '+50 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-50-59-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month for 50-59 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+50 years') <= date('now'))
                      AND (date(fm.dob, '+60 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-50-59-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month for 50-59 year olds"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+50 years') <= date('now'))
                      AND (date(fm.dob, '+60 years') > date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-60-me"
    grouping: "CBHS"
    description: "Total new male clients registered this month above 60 years"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+60 years') <= date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2a-60-ke"
    grouping: "CBHS"
    description: "Total new female clients registered this month above 60 years"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Female'
                      AND (ecf.registration_or_followup_status = 'new_client' or ecr.registration_or_followup_status is null)
                      AND (date(fm.dob, '+60 years') <= date('now'))
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-1-jumla-me"
    grouping: "CBHS"
    description: "Total male with HIV infections"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'hiv_aids'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-1-jumla-ke"
    grouping: "CBHS"
    description: "Total female with HIV infections"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'hiv_aids'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-2-jumla-me"
    grouping: "CBHS"
    description: "Total male with Tuberculosis"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'tuberculosis'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-2-jumla-ke"
    grouping: "CBHS"
    description: "Total male with Tuberculosis"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'tuberculosis'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-3-jumla-me"
    grouping: "CBHS"
    description: "Total homosexuals"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'homosexual'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-4-jumla-ke"
    grouping: "CBHS"
    description: "Total Sex workers"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'sex_worker_woman'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-5-jumla-me"
    grouping: "CBHS"
    description: "Total male infants born with HIV infections"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'hiv_infected_child'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-5-jumla-ke"
    grouping: "CBHS"
    description: "Total female infants born with HIV infections"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'hiv_infected_child'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-6-jumla-me"
    grouping: "CBHS"
    description: "Total HIV  untested male infants"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'untested_hiv_infected_child'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-6-jumla-ke"
    grouping: "CBHS"
    description: "Total HIV untested female infants"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'untested_hiv_infected_child'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-7-jumla-me"
    grouping: "CBHS"
    description: "Total male children abused"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                      INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                      fm.gender = 'Male'
                      AND ecr.reasons_for_registration = 'abused_child'
                      AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-7-jumla-ke"
    grouping: "CBHS"
    description: "Total Female children abused"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Female'
                        AND ecr.reasons_for_registration = 'abused_child'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-8-jumla-me"
    grouping: "CBHS"
    description: "Total Male gender violence"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Male'
                        AND ecr.reasons_for_registration = 'gender_violence'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-8-jumla-ke"
    grouping: "CBHS"
    description: "Total Female gender violence"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                          FROM ec_cbhs_register ecr
                          INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                          WHERE
                          fm.gender = 'Female'
                          AND ecr.reasons_for_registration = 'gender_violence'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-9-jumla-me"
    grouping: "CBHS"
    description: "Total Male drug addicts"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                        FROM ec_cbhs_register ecr
                        INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                        WHERE
                        fm.gender = 'Male'
                        AND ecr.reasons_for_registration = 'drug_abuse'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                        substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                        date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-9-jumla-ke"
    grouping: "CBHS"
    description: "Total Female drug addicts"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                          FROM ec_cbhs_register ecr
                          INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                          WHERE
                          fm.gender = 'Female'
                          AND ecr.reasons_for_registration = 'drug_abuse'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-10-jumla-ke"
    grouping: "CBHS"
    description: "Total pregnant women"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                          FROM ec_cbhs_register ecr
                          INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                          WHERE
                          fm.gender = 'Female'
                          AND ecr.reasons_for_registration = 'pregnant_mother'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2b-11-jumla-ke"
    grouping: "CBHS"
    description: "Total breast feeding mothers"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                          FROM ec_cbhs_register ecr
                          INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                          WHERE
                          fm.gender = 'Female'
                          AND ecr.reasons_for_registration = 'breastfeeding_mother'
                          AND date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                          substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                          date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2c-2-jumla-me"
    grouping: "CBHS"
    description: "Total male infected with HIV"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'positive'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'positive'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2c-2-jumla-ke"
    grouping: "CBHS"
    description: "Total female infected with HIV"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'positive'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'positive'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2c-3-jumla-me"
    grouping: "CBHS"
    description: "Total male not infected with HIV"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'negative'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'negative'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2c-3-jumla-ke"
    grouping: "CBHS"
    description: "Total female not infected with HIV"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'negative'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'negative'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2c-4-jumla-me"
    grouping: "CBHS"
    description: "Total male unknown HIV status"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'unknown'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'unknown'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2c-4-jumla-ke"
    grouping: "CBHS"
    description: "Total female unknown HIV status"
    indicatorQuery: "SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND (
                              (ecr.client_hiv_status_during_registration = 'unknown'
                                  AND
                               date(substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 1,
                                           4) || '-' ||
                                    substr(strftime('%Y-%m-%d', datetime(ecr.hiv_registration_date / 1000, 'unixepoch', 'localtime')), 6,
                                           2) || '-' || '01') =
                               date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01')))
                              OR (ecf.client_hiv_status_after_testing = 'unknown'
                              AND
                                  date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1,
                                              4) || '-' ||
                                       substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6,
                                              2) || '-' || '01') =
                                  date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))))"

  - key: "cbhs-2d-1-jumla-me"
    grouping: "CBHS"
    description: "Total male given HIV counselling and testing"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%hiv_counselling_and_testing%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-1-jumla-ke"
    grouping: "CBHS"
    description: "Total female given HIV counselling and testing"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%hiv_counselling_and_testing%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-2-jumla-me"
    grouping: "CBHS"
    description: "Total male given ARV medication"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%arv_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-2-jumla-ke"
    grouping: "CBHS"
    description: "Total female given ARV medication"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%arv_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-3-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%hiv_prevention_services_from_mother_to_infant%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-3-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%hiv_prevention_services_from_mother_to_infant%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-4-jumla-me"
    grouping: "CBHS"
    description: "Total male given Collaborative HIV and TB Health services"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%collaborative_community_services_for_tb_and_hiv%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-4-jumla-ke"
    grouping: "CBHS"
    description: "Total female given Collaborative HIV and TB Health services"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%collaborative_community_services_for_tb_and_hiv%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-5-jumla-me"
    grouping: "CBHS"
    description: "Total male given services to reduce the spread of STDs"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.hiv_services_provided LIKE '%prevention_of_the_spread_of_stds_service%' AND fm.gender = 'Male'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-5-jumla-ke"
    grouping: "CBHS"
    description: "Total female given services to reduce the spread of STDs"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                         ecf.hiv_services_provided LIKE '%prevention_of_the_spread_of_stds_service%' AND fm.gender = 'Female'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-6-jumla-me"
    grouping: "CBHS"
    description: "Total male given special group services"
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%for_special_group_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-6-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%for_special_group_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-7-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%prevention_of_gender_based_violence_and_child_abuse_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-7-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%prevention_of_gender_based_violence_and_child_abuse_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-8-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%psychological_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-8-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%psychological_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-9-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%information_about_fgm%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-9-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%information_about_fgm%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-10-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%family_planning_and_condom_distribution_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-10-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%family_planning_and_condom_distribution_services%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-11-jumla-me"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Male'
                        AND ecf.hiv_services_provided LIKE '%distribution_of_self_test_kits%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-2d-11-jumla-ke"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE fm.gender = 'Female'
                        AND ecf.hiv_services_provided LIKE '%distribution_of_self_test_kits%'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-jumla"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status <> 'client_continues_with_clinic_from_elsewhere' AND  ecf.registration_or_followup_status <> 'new_client' AND ecf.registration_or_followup_status <> 'continuing_with_services'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-deseased"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status = 'deceased'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-continue-with-clinic-from-elsewhere"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status = 'client_continues_with_clinic_from_elsewhere'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-moved"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status = 'client_has_moved'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-absconded"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status = 'client_has_absconded'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"

  - key: "cbhs-5-completed_and_qualified_from_the_services"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.base_entity_id) as count
                      FROM ec_cbhs_register ecr
                               INNER JOIN ec_cbhs_followup ecf on ecf.entity_id = ecr.base_entity_id
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ecr.base_entity_id
                      WHERE
                        ecf.registration_or_followup_status = 'completed_and_qualified_from_the_services'
                        AND date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01') =
                            date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-6-kisheria"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_issued_to_other_services ,'legal_services')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-6-vikundi"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_issued_to_other_services ,'support_groups')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-6-huduma-zingine"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_issued_to_other_services ,'other_referrals')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-7-kisheria"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_to_other_services_completed ,'legal_services')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-7-vikundi"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_to_other_services_completed ,'support_groups')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-7-huduma-zingine"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecf.entity_id) as count
                      FROM ec_cbhs_followup ecf
                      WHERE  instr(ecf.referrals_to_other_services_completed ,'other_referrals')  AND
                      date(substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecf.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"
  - key: "cbhs-8-jumla"
    grouping: "CBHS"
    description: ""
    indicatorQuery: " SELECT count(DISTINCT ecr.provider_id) as count
                      FROM ec_cbhs_register ecr
                      WHERE date(substr(strftime('%Y-%m-%d', datetime(ecr.last_interacted_with / 1000, 'unixepoch', 'localtime')), 1, 4) || '-' ||
                      substr(strftime('%Y-%m-%d', datetime(ecr.last_interacted_with / 1000, 'unixepoch', 'localtime')), 6, 2) || '-' || '01') =
                      date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'))"